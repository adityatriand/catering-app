<!DOCTYPE html>
<html>
  <head>
    <title><%= yield(:title) %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <link rel="icon" href="<%= image_url('logo-food-app.png') %>">
  </head>
  <body>
    <div class="container">
      <%= yield %>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Convert UTC timestamps to client's local timezone
      document.addEventListener('DOMContentLoaded', function() {
        const orderDateElements = document.querySelectorAll('.order-date[data-utc-time]');
        
        orderDateElements.forEach(function(element) {
          const utcTimeString = element.getAttribute('data-utc-time');
          if (utcTimeString) {
            try {
              const utcDate = new Date(utcTimeString);
              
              // Format parts separately for better control
              const parts = new Intl.DateTimeFormat('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZoneName: 'short'
              }).formatToParts(utcDate);
              
              // Extract parts
              const weekday = parts.find(p => p.type === 'weekday')?.value || '';
              const day = parts.find(p => p.type === 'day')?.value || '';
              const month = parts.find(p => p.type === 'month')?.value || '';
              const year = parts.find(p => p.type === 'year')?.value || '';
              const hour = parts.find(p => p.type === 'hour')?.value || '';
              const minute = parts.find(p => p.type === 'minute')?.value || '';
              const timeZoneName = parts.find(p => p.type === 'timeZoneName')?.value || '';
              
              // Format: "Saturday, 01 November 2025 at 02:31 PST"
              const formattedDate = `${weekday}, ${day.padStart(2, '0')} ${month} ${year} at ${hour}:${minute} ${timeZoneName}`;
              
              // Update the element text
              element.textContent = formattedDate;
            } catch (error) {
              console.error('Error converting date:', error);
            }
          }
        });
      });
    </script>
  </body>
</html>
